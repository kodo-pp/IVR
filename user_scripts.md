# Пользовательские сценарии

## Содержание
1. [Загрузка из локального сохранения](#загрузка-из-локального-сохранения)
2. [Автоматическая установка модулей](#автоматическая-установка-модулей)
3. [Атака врага](#атака-врага)
4. [Размещение объекта в игровом мире](#размещение-объекта-в-игровом-мире)
5. [Создание нового игрового мира](#создание-нового-игрового-мира)
6. [Удаление модуля](#удаление-модуля)

## Загрузка из локального сохранения
**Сценарий**:
1.  Пользователь нажимает на кнопку «Одиночная игра» в главном меню, затем
    «Играть в существующем мире»

2.  Программа просматривает список локальных сохранений (миров), лежащих
    в определённом каталоге (создаётся, если не существует) и получает о
    каждом мире базовую информацию, вроде названия и даты последней
    загрузки

3.  Программа формирует список из этих миров и выводит его пользователю
    (показывая информацию, полученную на шаге 2)

4.  Пользователь выбирает один из этих миров, затем нажимает кнопку
    «Играть в этом мире»

5.  Программа загружает список используемых в мире модулей

6.  Программа сравнивает этот список со списком установленных у
    пользователя модулей. Если (у пользователя) каких-то модулей
    недостаёт, то совершается попытка их автоматически установить (см.
    [Автоматическая установка модулей](#автоматическая-установка-модулей))

7.  После установки всех необходимых модулей (или если она не
    понадобилась) программа загружает информацию о местоположении игрока
    в мире

8.  Программа загружает в оперативную память территорию рядом с игроком

9.  Программа начинает отображать вид от игрока (от 1 лица), начинается
    обработка различных событий. Пользователь вошёл в мир и может
    играть

## Автоматическая установка модулей
**Примечание**: происходит при заходе в локальный мир, если какие-то модули
используются в мире, но не установлены у пользователя. Пользователь
этого не делает напрямую, но необходимость в этом может возникнуть при
определённых действиях пользователя.

**Сценарий**:
1.  Программа считывает из сохранения информацию об используемых модулях
    и формирует список недостающих

2.  Для каждого модуля из этого списка программа определяет, принадлежит
    ли он стандартной библиотеке модулей или нет

3.  Если недостаёт некоторых модулей из стандартной библиотеки, то
    программа предлагает пользователю обновить её

    1.  Отображается просьба обновить библиотеку и вопрос, выполнить ли
        обновление, с вариантами «Да» (обновить) и «Нет» (не обновлять)

    2.  Пользователь выбирает один из вариантов «Да» и «Нет»

    3.  При нажатии кнопки «Нет» происходит отмена обновления

    4.  При нажатии кнопки «Да» загружается последняя версия библиотеки,
        затем происходит установка модулей из неё

    5.  При необходимости, отображается просьба перезапустить игру

4.  Если недостаёт других модулей, то у пользователя спрашивается,
    установить ли эти модули?

5.  При ответе «Нет» установка отменяется

6.  При ответе «Да» происходит попытка загрузить и установить данные модули.
    Это возможно только если программа имеет информацию об этих модулях
    (например, они доступны в пакетном менеджере системы), в противном случае
    пользователь должен сам найти и установить эти модули. При возникновении
    ошибок пользователю отображается информация о них, и установка отменяется

## Атака врага
**Примечание**: предполагается, что пользователь уже зашёл в игровой мир и
находится в нём. Данная функциональность будет представлена не в ядре, а
в модулях

**Сценарий**:
1.  Игрок берёт в руки оружие ближнего или дальнего боя

2.  Игрок наводит прицел на врага и подходит к нему на расстояние удара
    или выстрела

3.  Игрок нажимает кнопку мыши для удара или выстрела

4.  Проверяется, может ли игрок совершить удар/выстрел этим оружием
    (например, мечом нельзя стрелять, а сломанным мечом нельзя и
    ударить)

5.  В зависимости от характеристик игрока, врага и оружия, вычисляется
    урон, наносимый врагу

6.  Если урон больше оставшегося здоровья врага, то он умирает

7.  В ином случае, показатель здоровья врага уменьшится на количество
    нанесённого урона

## Размещение объекта в игровом мире
**Примечание**: предполагается, что пользователь уже зашёл в игровой мир и
находится в нём. Данная функциональность будет представлена не в ядре, а
в модулях

**Сценарий**:
1.  Игрок берёт в инвентарь объект или все его части

2.  Игрок берёт в руки объект или одну из его частей и наводит прицел
    (указатель по центру экрана) на место, где он хочет его разместить

3.  Игрок нажимает правую кнопку мыши для размещения объекта

4.  Проверяется, можно ли разместить данный объект на данном месте

5.  Если нет, то ничего не происходит

6.  Если да, то ставится объект или его часть

7.  Если есть непоставленные части объекта, то пользователь должен взять
    повторить эту операцию с каждой из частей, таким образом «собирая»
    объект

## Создание нового игрового мира
**Сценарий**:
1.  Пользователь нажимает на кнопку «Одиночная игра», затем «Создать
    новый мир»

2.  У пользователя спрашиваются параметры, с которыми будет создаваться
    мир:

    1.  Название мира

    2.  Используемые модули (только стандартные, все установленные, из
        списка и т.п.)

    3.  Игровой режим по-умолчанию (режим приключения или строительства)

    4.  Возможно, некоторые параметры генерации

3.  Пользователь вводит значения указанных параметров и нажимает кнопку
    «Создать новый мир»

4.  Создаётся локальное сохранение, в него копируются указанные модули
    (кроме стандартных), затем генерируется и сохраняется участок территории
    рядом с игроком

5.  Игрок попадает в созданный мир

## Удаление модуля
**Примечание**: модули из стандартной библиотеки удалить нельзя, но они
будут показаны в списке

**Сценарий**:
1.  Отображается список всех установленных модулей

2.  Пользователь выбирает один из них

3.  Отображается информация об этом модуле и варианты действий:
    обновить, удалить, включить/отключить и т.п.

4.  Если кнопка «Удалить» неактивна (невозможно нажать её), это значит,
    что данный модуль невозможно удалить

5.  Если удаление возможно, пользователь нажимает на кнопку «Удалить»

6.  Отобразится подтверждение удаления модуля: *«Вы действительно хотите
    удалить этот модуль?»*. Если от этого модуля зависят другие, то они
    тоже будут удалены (и об этом сообщится пользователю). Пользователь
    отвечает «Да» или «Нет»

7.  При ответе «Нет» удаление отменяется

8.  При ответе «Да» данный модуль и зависящие от него удаляются
